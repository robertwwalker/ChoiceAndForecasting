<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert W. Walker">
<meta name="dcterms.date" content="2022-09-05">

<title>Models of Choice and Forecasting - Week 2: Inference and Regression: A Review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Models of Choice and Forecasting - Week 2: Inference and Regression: A Review">
<meta name="twitter:description" content="The slides are here.">
<meta name="twitter:image" content="image.png">
<meta name="twitter:creator" content="@PieRatio">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Models of Choice and Forecasting</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/robertwwalker/ChoiceAndForecasting"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/PieRatio"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week 2: Inference and Regression: A Review</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Robert W. Walker </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 5, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>The slides <a href="https://robertwwalker.github.io/xaringan/CMF-Week-2/">are here.</a></p>
<p>Our second class meeting will focus on <a href="https://peopleanalytics-regression-book.org/gitbook/found-stats.html">Chapter 3</a>; and <a href="https://peopleanalytics-regression-book.org/gitbook/linear-reg-ols.html">Chapter 4</a> of <strong>Handbook of Regression Modeling in People Analytics</strong> for next time.</p>
<section id="chapter-3" class="level1">
<h1>Chapter 3</h1>
<section id="hypothesis-tests-and-confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-tests-and-confidence-intervals">Hypothesis Tests and Confidence Intervals</h2>
<section id="single-means-with-the-cars-data" class="level3">
<h3 class="anchored" data-anchor-id="single-means-with-the-cars-data">Single means with the cars data</h3>
<p>I will work with R’s internal dataset on cars: <code>cars</code>. There are two variables in the dataset, this is what they look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/cars-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="an-hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="an-hypothesis-test">An Hypothesis Test</h2>
<p>I will work with the speed variable. The hypothesis to advance is that 17 or greater is the true average speed. The alternative must then be that the average speed is less than 17. Knowing only the sample size, I can figure out what <span class="math inline">\(t\)</span> must be to reject 17 or greater and conclude that the true average must be less with 90% probability. The sample mean would have to be at least <code>qt(0.1, 49)</code> standard errors below 17 to rule out a mean of 17 or greater. Now let’s see what we have. Let me skim the data for the relevant information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">cars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">speed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.40</td>
<td style="text-align: right;">5.29</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">▂▅▇▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">dist</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">42.98</td>
<td style="text-align: right;">25.77</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">120</td>
<td style="text-align: left;">▅▇▅▂▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Doing the math by hand, I get:</p>
<p><span class="math display">\[ t = \frac{\overline{x} - \mu}{\frac{s}{\sqrt{n}}} = \frac{15.4 - 17}{\frac{5.29}{\sqrt{50}}} = -2.14 \]</span></p>
<p>Interpreting the result, the sample mean is 2.14 standard errors below the hypothetical mean of 17. The probability of a sample mean of 15.4 [or smaller] given a true average of 17, this standard deviation and sample size is <code>pt(-2.14, 49)</code> = 0.0186798. Notice that probability is less than 0.1; thus with at least 90% confidence, the true mean is not 17 or greater and thus must be smaller. Assuming the hypothetical mean [17 or greater] is true, the likelihood of generating a sample mean of 15.4 is only 0.0187 and this is far less than the 10% permissible outside of 90% confidence. Indeed, any sample mean more than 1.299 standard errors below 17 would be too small to sustain the belief that the true mean is 17 or greater because <code>qt(0.1, 49)</code> is -1.299. Put in the original metric, any sample mean below 16.0285747 would require a rejection of the claim that the true mean is 17 or greater with 90% confidence.</p>
</section>
<section id="the-confidence-interval" class="level2">
<h2 class="anchored" data-anchor-id="the-confidence-interval">The Confidence Interval</h2>
<p>The confidence interval is always centered on the sample mean. Rearranging the equation above and solving for <span class="math inline">\(\mu\)</span> given the <span class="math inline">\(t\)</span> above, we get</p>
<p><span class="math display">\[ \mu = \overline{x} - t(\frac{s}{\sqrt{n}}) = 15.4 - (-1.299*\frac{5.29}{\sqrt{50}}) = 16.37143 \]</span></p>
<p>With 90% confidence, given this sample mean, the true value should be less than 16.37143.</p>
</section>
<section id="the-native-t.test" class="level2">
<h2 class="anchored" data-anchor-id="the-native-t.test">The native <code>t.test</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(cars<span class="sc">$</span>speed, <span class="at">conf.level =</span> <span class="fl">0.9</span>, <span class="at">alternative =</span> <span class="st">"less"</span>, <span class="at">mu=</span><span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  cars$speed
t = -2.1397, df = 49, p-value = 0.01869
alternative hypothesis: true mean is less than 17
90 percent confidence interval:
     -Inf 16.37143
sample estimates:
mean of x 
     15.4 </code></pre>
</div>
</div>
</section>
<section id="simplifying" class="level2">
<h2 class="anchored" data-anchor-id="simplifying">Simplifying?</h2>
<p><span class="math display">\[ t(\frac{s}{\sqrt{n}}) = \overline{x} - \mu \]</span> can lead to either:</p>
<p><span class="math display">\[  \overline{x} - t(\frac{s}{\sqrt{n}}) = \mu \]</span></p>
<p>or</p>
<p><span class="math display">\[ \overline{x} = \mu + t(\frac{s}{\sqrt{n}}) \]</span></p>
<p>So a minus <span class="math inline">\(t\)</span> will be below <span class="math inline">\(\mu\)</span> but above <span class="math inline">\(\overline{x}\)</span> and a positive <span class="math inline">\(t\)</span> will be above <span class="math inline">\(\mu\)</span> but below <span class="math inline">\(\overline{x}\)</span>.<br>
1. An hypothesis test given <span class="math inline">\(\mu\)</span> with an alternative that is less must then render an upper bound given <span class="math inline">\(\overline{x}\)</span>.<br>
2. An hypothesis test given <span class="math inline">\(\mu\)</span> with an alternative that is greater must then render a lower bound given <span class="math inline">\(\overline{x}\)</span>.</p>
</section>
<section id="a-graphical-representation" class="level2">
<h2 class="anchored" data-anchor-id="a-graphical-representation">A graphical representation</h2>
<p>Given a sample size <span class="math inline">\(n\)</span>, some unknown constant <span class="math inline">\(\mu\)</span> and satisfaction of Lindeberg’s condition, the sampling distribution of the sample mean follows a <span class="math inline">\(t\)</span> distribution with degrees of freedom <span class="math inline">\(n-1\)</span>. To render a graphical representation, let’s arbitrarily set n to 50, as in the above example. Here is a plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"x-bar -"</span>,mu,<span class="st">" (measured in std. errors of the mean)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="inverting-the-scale-transformation" class="level3">
<h3 class="anchored" data-anchor-id="inverting-the-scale-transformation">Inverting the <code>scale</code> transformation</h3>
<p>We can now reverse the scale by the standard error of the mean. In the above example, it is 0.7478. Measured in miles per hour, we obtain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"x-bar -"</span>,mu,<span class="st">" (measured in mph)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we will take the concrete example above.</p>
</section>
<section id="the-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="the-hypothesis-test">The Hypothesis Test</h3>
<p>We claim that the true mean is 17 or greater. Now we need center the distribution above as though the claim is true.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">17</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(mu,<span class="st">" (measured in mph)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">17</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">17</span><span class="sc">+</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="dv">21</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The sample mean is estimated to be 15.4. How likely is that?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">17</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"x-bar -"</span>,mu,<span class="st">" (measured in mph)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">17</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">15.4</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">17</span><span class="sc">+</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="dv">21</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">17</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="fl">2.14</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="fl">2.14</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="dv">0</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">17</span> <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.1</span>, <span class="at">df=</span><span class="dv">49</span>)<span class="sc">*</span><span class="fl">0.7874</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The probability of seeing such a small sample mean if the true average is 17 is only 0.01869. The probability above the dotted black line is 0.9 with 0.1 below. WIth 90% confidence, anything below this would be sufficient evidence to reject the claim that the true average is 17 or above.</p>
</section>
</section>
<section id="the-confidence-interval-1" class="level2">
<h2 class="anchored" data-anchor-id="the-confidence-interval-1">The Confidence Interval</h2>
<p>Let’s take the sample mean as the center and work out a confidence interval at 90%. It’s exactly the 16.37143 gives above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fl">15.4</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(mu,<span class="st">" | x-bar (measured in mph)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">15.4</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">15.4</span> <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.1</span>, <span class="at">df=</span><span class="dv">49</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="fl">15.4</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">1.3</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">1.3</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="dv">0</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As an aside, 17 has exactly 0.01869 probability above it shown in orange.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fl">15.4</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(mu,<span class="st">" | x-bar (measured in mph)"</span>, <span class="at">sep=</span><span class="st">""</span>)), <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">15.4</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">15.4</span> <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.1</span>, <span class="at">df=</span><span class="dv">49</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="fl">15.4</span><span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">1.3</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">1.3</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="dv">0</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">15.4</span><span class="sc">+</span><span class="fu">seq</span>(<span class="fl">2.14</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">*</span><span class="fl">0.7478</span>, <span class="dv">17</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">dt</span>(<span class="fu">seq</span>(<span class="fl">2.14</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="fl">0.01</span>), <span class="at">df=</span><span class="dv">49</span>), <span class="dv">0</span>), <span class="at">col =</span> <span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="chapter-4-linear-regression" class="level1">
<h1>Chapter 4: Linear Regression</h1>
<p>A linear regression example. The data can be loaded from the web.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if needed, download ugtests data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://peopleanalytics-regression-book.org/data/ugtests.csv"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ugtests <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ugtests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   975 obs. of  4 variables:
 $ Yr1  : int  27 70 27 26 46 86 40 60 49 80 ...
 $ Yr2  : int  50 104 36 75 77 122 100 92 98 127 ...
 $ Yr3  : int  52 126 148 115 75 119 125 78 119 67 ...
 $ Final: int  93 207 175 125 114 159 153 84 147 80 ...</code></pre>
</div>
</div>
<p>There are 975 individuals graduating in the past three years from the biology department of a large academic institution. We have data on four examinations:</p>
<ul>
<li>a first year exam ranging from 0 to 100 (Yr1)</li>
<li>a second year exam ranging from 0 to 200 (Yr2)</li>
<li>a third year exam ranging from 0 to 200 (Yr3)</li>
<li>a Final year exam ranging from 0 to 300 (Final)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr); <span class="fu">library</span>(kableExtra)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(ugtests) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skim_type<span class="sc">==</span><span class="st">"numeric"</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> skim_type </th>
   <th style="text-align:left;"> skim_variable </th>
   <th style="text-align:right;"> n_missing </th>
   <th style="text-align:right;"> complete_rate </th>
   <th style="text-align:right;"> numeric.mean </th>
   <th style="text-align:right;"> numeric.sd </th>
   <th style="text-align:right;"> numeric.p0 </th>
   <th style="text-align:right;"> numeric.p25 </th>
   <th style="text-align:right;"> numeric.p50 </th>
   <th style="text-align:right;"> numeric.p75 </th>
   <th style="text-align:right;"> numeric.p100 </th>
   <th style="text-align:left;"> numeric.hist </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Yr1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 52.14564 </td>
   <td style="text-align:right;"> 14.92408 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 42 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 62 </td>
   <td style="text-align:right;"> 99 </td>
   <td style="text-align:left;"> ▁▃▇▅▁ </td>
  </tr>
  <tr>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Yr2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 92.39897 </td>
   <td style="text-align:right;"> 30.03847 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 73 </td>
   <td style="text-align:right;"> 94 </td>
   <td style="text-align:right;"> 112 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:left;"> ▁▅▇▃▁ </td>
  </tr>
  <tr>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Yr3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 105.12103 </td>
   <td style="text-align:right;"> 33.50705 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 81 </td>
   <td style="text-align:right;"> 105 </td>
   <td style="text-align:right;"> 130 </td>
   <td style="text-align:right;"> 198 </td>
   <td style="text-align:left;"> ▁▅▇▅▁ </td>
  </tr>
  <tr>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Final </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 148.96205 </td>
   <td style="text-align:right;"> 44.33966 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 118 </td>
   <td style="text-align:right;"> 147 </td>
   <td style="text-align:right;"> 175 </td>
   <td style="text-align:right;"> 295 </td>
   <td style="text-align:left;"> ▁▅▇▃▁ </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="a-visual-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="a-visual-of-the-data">A Visual of the Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display a pairplot of all four columns of data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(ugtests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>